<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <meta http-equiv="Content-Style-Type" content="text/css" />
  <meta name="generator" content="pandoc" />
  <title></title>
  <style type="text/css">code{white-space: pre;}</style>
  <style type="text/css">
  
  /*! normalize.css v2.1.3 | MIT License | git.io/normalize */
  
  /* ==========================================================================
     HTML5 display definitions
     ========================================================================== */
  
  /**
   * Correct `block` display not defined in IE 8/9.
   */
  
  article,
  aside,
  details,
  figcaption,
  figure,
  footer,
  header,
  hgroup,
  main,
  nav,
  section,
  summary {
      display: block;
  }
  
  /**
   * Correct `inline-block` display not defined in IE 8/9.
   */
  
  audio,
  canvas,
  video {
      display: inline-block;
  }
  
  /**
   * Prevent modern browsers from displaying `audio` without controls.
   * Remove excess height in iOS 5 devices.
   */
  
  audio:not([controls]) {
      display: none;
      height: 0;
  }
  
  /**
   * Address `[hidden]` styling not present in IE 8/9.
   * Hide the `template` element in IE, Safari, and Firefox < 22.
   */
  
  [hidden],
  template {
      display: none;
  }
  
  /* ==========================================================================
     Base
     ========================================================================== */
  
  /**
   * 1. Set default font family to sans-serif.
   * 2. Prevent iOS text size adjust after orientation change, without disabling
   *    user zoom.
   */
  
  html {
      font-family: sans-serif; /* 1 */
      -ms-text-size-adjust: 100%; /* 2 */
      -webkit-text-size-adjust: 100%; /* 2 */
  }
  
  /**
   * Remove default margin.
   */
  
  body {
      margin: 0;
  }
  
  /* ==========================================================================
     Links
     ========================================================================== */
  
  /**
   * Remove the gray background color from active links in IE 10.
   */
  
  a {
      background: transparent;
  }
  
  /**
   * Address `outline` inconsistency between Chrome and other browsers.
   */
  
  a:focus {
      outline: thin dotted;
  }
  
  /**
   * Improve readability when focused and also mouse hovered in all browsers.
   */
  
  a:active,
  a:hover {
      outline: 0;
  }
  
  /* ==========================================================================
     Typography
     ========================================================================== */
  
  /**
   * Address variable `h1` font-size and margin within `section` and `article`
   * contexts in Firefox 4+, Safari 5, and Chrome.
   */
  
  h1 {
      font-size: 2em;
      margin: 0.67em 0;
  }
  
  /**
   * Address styling not present in IE 8/9, Safari 5, and Chrome.
   */
  
  abbr[title] {
      border-bottom: 1px dotted;
  }
  
  /**
   * Address style set to `bolder` in Firefox 4+, Safari 5, and Chrome.
   */
  
  b,
  strong {
      font-weight: bold;
  }
  
  /**
   * Address styling not present in Safari 5 and Chrome.
   */
  
  dfn {
      font-style: italic;
  }
  
  /**
   * Address differences between Firefox and other browsers.
   */
  
  hr {
      -moz-box-sizing: content-box;
      box-sizing: content-box;
      height: 0;
  }
  
  /**
   * Address styling not present in IE 8/9.
   */
  
  mark {
      background: #ff0;
      color: #000;
  }
  
  /**
   * Correct font family set oddly in Safari 5 and Chrome.
   */
  
  code,
  kbd,
  pre,
  samp {
      font-family: monospace, serif;
      font-size: 1em;
  }
  
  /**
   * Improve readability of pre-formatted text in all browsers.
   */
  
  pre {
      white-space: pre-wrap;
  }
  
  /**
   * Set consistent quote types.
   */
  
  q {
      quotes: "\201C" "\201D" "\2018" "\2019";
  }
  
  /**
   * Address inconsistent and variable font size in all browsers.
   */
  
  small {
      font-size: 80%;
  }
  
  /**
   * Prevent `sub` and `sup` affecting `line-height` in all browsers.
   */
  
  sub,
  sup {
      font-size: 75%;
      line-height: 0;
      position: relative;
      vertical-align: baseline;
  }
  
  sup {
      top: -0.5em;
  }
  
  sub {
      bottom: -0.25em;
  }
  
  /* ==========================================================================
     Embedded content
     ========================================================================== */
  
  /**
   * Remove border when inside `a` element in IE 8/9.
   */
  
  img {
      border: 0;
  }
  
  /**
   * Correct overflow displayed oddly in IE 9.
   */
  
  svg:not(:root) {
      overflow: hidden;
  }
  
  /* ==========================================================================
     Figures
     ========================================================================== */
  
  /**
   * Address margin not present in IE 8/9 and Safari 5.
   */
  
  figure {
      margin: 0;
  }
  
  /* ==========================================================================
     Forms
     ========================================================================== */
  
  /**
   * Define consistent border, margin, and padding.
   */
  
  fieldset {
      border: 1px solid #c0c0c0;
      margin: 0 2px;
      padding: 0.35em 0.625em 0.75em;
  }
  
  /**
   * 1. Correct `color` not being inherited in IE 8/9.
   * 2. Remove padding so people aren't caught out if they zero out fieldsets.
   */
  
  legend {
      border: 0; /* 1 */
      padding: 0; /* 2 */
  }
  
  /**
   * 1. Correct font family not being inherited in all browsers.
   * 2. Correct font size not being inherited in all browsers.
   * 3. Address margins set differently in Firefox 4+, Safari 5, and Chrome.
   */
  
  button,
  input,
  select,
  textarea {
      font-family: inherit; /* 1 */
      font-size: 100%; /* 2 */
      margin: 0; /* 3 */
  }
  
  /**
   * Address Firefox 4+ setting `line-height` on `input` using `!important` in
   * the UA stylesheet.
   */
  
  button,
  input {
      line-height: normal;
  }
  
  /**
   * Address inconsistent `text-transform` inheritance for `button` and `select`.
   * All other form control elements do not inherit `text-transform` values.
   * Correct `button` style inheritance in Chrome, Safari 5+, and IE 8+.
   * Correct `select` style inheritance in Firefox 4+ and Opera.
   */
  
  button,
  select {
      text-transform: none;
  }
  
  /**
   * 1. Avoid the WebKit bug in Android 4.0.* where (2) destroys native `audio`
   *    and `video` controls.
   * 2. Correct inability to style clickable `input` types in iOS.
   * 3. Improve usability and consistency of cursor style between image-type
   *    `input` and others.
   */
  
  button,
  html input[type="button"], /* 1 */
  input[type="reset"],
  input[type="submit"] {
      -webkit-appearance: button; /* 2 */
      cursor: pointer; /* 3 */
  }
  
  /**
   * Re-set default cursor for disabled elements.
   */
  
  button[disabled],
  html input[disabled] {
      cursor: default;
  }
  
  /**
   * 1. Address box sizing set to `content-box` in IE 8/9/10.
   * 2. Remove excess padding in IE 8/9/10.
   */
  
  input[type="checkbox"],
  input[type="radio"] {
      box-sizing: border-box; /* 1 */
      padding: 0; /* 2 */
  }
  
  /**
   * 1. Address `appearance` set to `searchfield` in Safari 5 and Chrome.
   * 2. Address `box-sizing` set to `border-box` in Safari 5 and Chrome
   *    (include `-moz` to future-proof).
   */
  
  input[type="search"] {
      -webkit-appearance: textfield; /* 1 */
      -moz-box-sizing: content-box;
      -webkit-box-sizing: content-box; /* 2 */
      box-sizing: content-box;
  }
  
  /**
   * Remove inner padding and search cancel button in Safari 5 and Chrome
   * on OS X.
   */
  
  input[type="search"]::-webkit-search-cancel-button,
  input[type="search"]::-webkit-search-decoration {
      -webkit-appearance: none;
  }
  
  /**
   * Remove inner padding and border in Firefox 4+.
   */
  
  button::-moz-focus-inner,
  input::-moz-focus-inner {
      border: 0;
      padding: 0;
  }
  
  /**
   * 1. Remove default vertical scrollbar in IE 8/9.
   * 2. Improve readability and alignment in all browsers.
   */
  
  textarea {
      overflow: auto; /* 1 */
      vertical-align: top; /* 2 */
  }
  
  /* ==========================================================================
     Tables
     ========================================================================== */
  
  /**
   * Remove most spacing between table cells.
   */
  
  table {
      border-collapse: collapse;
      border-spacing: 0;
  }
  
  .go-top {
  position: fixed;
  bottom: 2em;
  right: 2em;
  text-decoration: none;
  background-color: #E0E0E0;
  font-size: 12px;
  padding: 1em;
  display: inline;
  }
  
  /* Github css */
  
  html,body{        margin: auto;
      padding-right: 1em;
      padding-left: 1em;
      max-width: 60em; color:black;}*:not('#mkdbuttons'){margin:0;padding:0}body{font:13.34px helvetica,arial,freesans,clean,sans-serif;-webkit-font-smoothing:subpixel-antialiased;line-height:1.4;padding:3px;background:#fff;border-radius:3px;-moz-border-radius:3px;-webkit-border-radius:3px}p{margin:1em 0}a{color:#4183c4;text-decoration:none}body{background-color:#fff;padding:30px;margin:15px;font-size:14px;line-height:1.6}body>*:first-child{margin-top:0!important}body>*:last-child{margin-bottom:0!important}@media screen{body{box-shadow:0 0 0 1px #cacaca,0 0 0 4px #eee}}h1,h2,h3,h4,h5,h6{margin:20px 0 10px;padding:0;font-weight:bold;-webkit-font-smoothing:subpixel-antialiased;cursor:text}h1{font-size:28px;color:#000}h2{font-size:24px;border-bottom:1px solid #ccc;color:#000}h3{font-size:18px;color:#333}h4{font-size:16px;color:#333}h5{font-size:14px;color:#333}h6{color:#777;font-size:14px}p,blockquote,table,pre{margin:15px 0}ul{padding-left:30px}ol{padding-left:30px}ol li ul:first-of-type{margin-top:0}hr{background:transparent url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAYAAAAECAYAAACtBE5DAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyJpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENTNSBNYWNpbnRvc2giIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6OENDRjNBN0E2NTZBMTFFMEI3QjRBODM4NzJDMjlGNDgiIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6OENDRjNBN0I2NTZBMTFFMEI3QjRBODM4NzJDMjlGNDgiPiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmlpZDo4Q0NGM0E3ODY1NkExMUUwQjdCNEE4Mzg3MkMyOUY0OCIgc3RSZWY6ZG9jdW1lbnRJRD0ieG1wLmRpZDo4Q0NGM0E3OTY1NkExMUUwQjdCNEE4Mzg3MkMyOUY0OCIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/PqqezsUAAAAfSURBVHjaYmRABcYwBiM2QSA4y4hNEKYDQxAEAAIMAHNGAzhkPOlYAAAAAElFTkSuQmCC) repeat-x 0 0;border:0 none;color:#ccc;height:4px;padding:0}body>h2:first-child{margin-top:0;padding-top:0}body>h1:first-child{margin-top:0;padding-top:0}body>h1:first-child+h2{margin-top:0;padding-top:0}body>h3:first-child,body>h4:first-child,body>h5:first-child,body>h6:first-child{margin-top:0;padding-top:0}a:first-child h1,a:first-child h2,a:first-child h3,a:first-child h4,a:first-child h5,a:first-child h6{margin-top:0;padding-top:0}h1+p,h2+p,h3+p,h4+p,h5+p,h6+p,ul li>:first-child,ol li>:first-child{margin-top:0}dl{padding:0}dl dt{font-size:14px;font-weight:bold;font-style:italic;padding:0;margin:15px 0 5px}dl dt:first-child{padding:0}dl dt>:first-child{margin-top:0}dl dt>:last-child{margin-bottom:0}dl dd{margin:0 0 15px;padding:0 15px}dl dd>:first-child{margin-top:0}dl dd>:last-child{margin-bottom:0}blockquote{border-left:4px solid #DDD;padding:0 15px;color:#777}blockquote>:first-child{margin-top:0}blockquote>:last-child{margin-bottom:0}table{border-collapse:collapse;border-spacing:0;font-size:100%;font:inherit}table th{font-weight:bold;border:1px solid #ccc;padding:6px 13px}table td{border:1px solid #ccc;padding:6px 13px}table tr{border-top:1px solid #ccc;background-color:#fff}table tr:nth-child(2n){background-color:#f8f8f8}img{max-width:100%}code,tt{margin:0 2px;padding:0 5px;white-space:nowrap;border:1px solid #eaeaea;background-color:#f8f8f8;border-radius:3px;font-family:Consolas,'Liberation Mono',Courier,monospace;font-size:12px;color:#333}pre>code{margin:0;padding:0;white-space:pre;border:0;background:transparent}.highlight pre{background-color:#f8f8f8;border:1px solid #ccc;font-size:13px;line-height:19px;overflow:auto;padding:6px 10px;border-radius:3px}pre{background-color:#f8f8f8;border:1px solid #ccc;font-size:13px;line-height:19px;overflow:auto;padding:6px 10px;border-radius:3px}pre code,pre tt{background-color:transparent;border:0}.poetry pre{font-family:Georgia,Garamond,serif!important;font-style:italic;font-size:110%!important;line-height:1.6em;display:block;margin-left:1em}.poetry pre code{font-family:Georgia,Garamond,serif!important;word-break:break-all;word-break:break-word;-webkit-hyphens:auto;-moz-hyphens:auto;hyphens:auto;white-space:pre-wrap}sup,sub,a.footnote{font-size:1.4ex;height:0;line-height:1;vertical-align:super;position:relative}sub{vertical-align:sub;top:-1px}@media print{body{background:#fff}img,pre,blockquote,table,figure{page-break-inside:avoid}body{background:#fff;border:0}code{background-color:#fff;color:#333!important;padding:0 .2em;border:1px solid #dedede}pre{background:#fff}pre code{background-color:white!important;overflow:visible}}@media screen{body.inverted{color:#eee!important;border-color:#555;box-shadow:none}.inverted body,.inverted hr .inverted p,.inverted td,.inverted li,.inverted h1,.inverted h2,.inverted h3,.inverted h4,.inverted h5,.inverted h6,.inverted th,.inverted .math,.inverted caption,.inverted dd,.inverted dt,.inverted blockquote{color:#eee!important;border-color:#555;box-shadow:none}.inverted td,.inverted th{background:#333}.inverted h2{border-color:#555}.inverted hr{border-color:#777;border-width:1px!important}::selection{background:rgba(157,193,200,0.5)}h1::selection{background-color:rgba(45,156,208,0.3)}h2::selection{background-color:rgba(90,182,224,0.3)}h3::selection,h4::selection,h5::selection,h6::selection,li::selection,ol::selection{background-color:rgba(133,201,232,0.3)}code::selection{background-color:rgba(0,0,0,0.7);color:#eee}code span::selection{background-color:rgba(0,0,0,0.7)!important;color:#eee!important}a::selection{background-color:rgba(255,230,102,0.2)}.inverted a::selection{background-color:rgba(255,230,102,0.6)}td::selection,th::selection,caption::selection{background-color:rgba(180,237,95,0.5)}.inverted{background:#0b2531;background:#252a2a}.inverted body{background:#252a2a}.inverted a{color:#acd1d5}}.highlight .c{color:#998;font-style:italic}.highlight .err{color:#a61717;background-color:#e3d2d2}.highlight .k,.highlight .o{font-weight:bold}.highlight .cm{color:#998;font-style:italic}.highlight .cp{color:#999;font-weight:bold}.highlight .c1{color:#998;font-style:italic}.highlight .cs{color:#999;font-weight:bold;font-style:italic}.highlight .gd{color:#000;background-color:#fdd}.highlight .gd .x{color:#000;background-color:#faa}.highlight .ge{font-style:italic}.highlight .gr{color:#a00}.highlight .gh{color:#999}.highlight .gi{color:#000;background-color:#dfd}.highlight .gi .x{color:#000;background-color:#afa}.highlight .go{color:#888}.highlight .gp{color:#555}.highlight .gs{font-weight:bold}.highlight .gu{color:#800080;font-weight:bold}.highlight .gt{color:#a00}.highlight .kc,.highlight .kd,.highlight .kn,.highlight .kp,.highlight .kr{font-weight:bold}.highlight .kt{color:#458;font-weight:bold}.highlight .m{color:#099}.highlight .s{color:#d14}.highlight .na{color:#008080}.highlight .nb{color:#0086b3}.highlight .nc{color:#458;font-weight:bold}.highlight .no{color:#008080}.highlight .ni{color:#800080}.highlight .ne,.highlight .nf{color:#900;font-weight:bold}.highlight .nn{color:#555}.highlight .nt{color:#000080}.highlight .nv{color:#008080}.highlight .ow{font-weight:bold}.highlight .w{color:#bbb}.highlight .mf,.highlight .mh,.highlight .mi,.highlight .mo{color:#099}.highlight .sb,.highlight .sc,.highlight .sd,.highlight .s2,.highlight .se,.highlight .sh,.highlight .si,.highlight .sx{color:#d14}.highlight .sr{color:#009926}.highlight .s1{color:#d14}.highlight .ss{color:#990073}.highlight .bp{color:#999}.highlight .vc,.highlight .vg,.highlight .vi{color:#008080}.highlight .il{color:#099}.highlight .gc{color:#999;background-color:#eaf2f5}.type-csharp .highlight .k,.type-csharp .highlight .kt{color:#00F}.type-csharp .highlight .nf{color:#000;font-weight:normal}.type-csharp .highlight .nc{color:#2b91af}.type-csharp .highlight .nn{color:#000}.type-csharp .highlight .s,.type-csharp .highlight .sc{color:#a31515}
  
  
  </style>
</head>
<body>
<h1 id="infrastructure">Infrastructure</h1>
<h2 id="recap-of-all-passwords">Recap of all passwords</h2>
<p>Connection to OVH server (ip is 5.196.28.226, hostname is vps377318.ovh.net) : there are 2 users (we give user:password), root:PBhPNiX4 and bio:pxFa4xALQFx. The command is :</p>
<pre><code>ssh bio@vps377318.ovh.net</code></pre>
<p>For mysql, we have 2 users : root:r$Qet7e3*wrE and website:B7p3ed!FuBr! (use website).</p>
<p>For phpmyadmin, the application password is root.</p>
<h2 id="add-a-sudo-user">Add a sudo user</h2>
<p>To add a user on the server and give it sudo privileges :</p>
<pre><code>ssh root@vps377318.ovh.net
adduser bio
usermod -aG sudo bio</code></pre>
<h2 id="git">Git</h2>
<p>Install git and tig :</p>
<pre><code>sudo apt-get install git
sudo apt-get install tig</code></pre>
<p>Generate RSA private and public keys on the server with :</p>
<pre><code>ssh-keygen</code></pre>
<p>Add the public key (in .ssh/id_rsa.pub) in the keys able to read/write this repo in bitbucket (avatar --&gt; bitbucket settings --&gt; add key). Finally, configure the identity of the server (the name appearing when pushes are made from the server) as requested the first time you push.</p>
<p>Clone the repository :</p>
<pre><code>git clone git@bitbucket.org:biosimul/bio_simulation.git</code></pre>
<h2 id="database">Database</h2>
<p>First, install mysql-server on the server with :</p>
<pre><code>sudo apt-get install mysql-server</code></pre>
<p>The password set in the installation for user 'root' is 'root'. Then, secure the installation by executing :</p>
<pre><code>/usr/bin/mysql_secure_installation</code></pre>
<p>You can then connect in command line to the database with :</p>
<pre><code>mysql -uroot -p</code></pre>
<p>The command 'status' enables to get a summary of the tables existing in the database. To be able to connect remotely to the database (django needs it), we need to activate remote access for MySQL database the following way :</p>
<ul>
<li>open file /etc/mysql/my.cnf</li>
<li>find the line bind-address : 127.0.0.1 and replace the ip by the server's ip</li>
<li>restart mysql server : sudo service mysql restart</li>
</ul>
<h2 id="phpmyadmin">PhpMyAdmin</h2>
<p>Install with :</p>
<pre><code>sudo apt-get install phpmyadmin</code></pre>
<p>During the installation, choose apache2 http server. The password set during the installation is 'root'. In the file /etc/apache2/apache2.conf, add in the end of the file the following line :</p>
<pre><code>Include /etc/phpmyadmin/apache.conf</code></pre>
<p>Restart apache2 server with :</p>
<pre><code>sudo service apache2 restart</code></pre>
<p>We need also to configure a sql user which can connect from all clients. We have created the user 'website' with password 'website'.</p>
<h2 id="website">Website</h2>
<p>Note that an admin account exists on the website : user is admin and password is bio_simulation.</p>
<h3 id="requirements">Requirements</h3>
<p>Install django :</p>
<pre><code>sudo apt-get install python-pip python-dev libmysqlclient-dev
sudo pip install MySQL-python
sudo pip install django</code></pre>
<p>We use mod_wsgi to run the website on an apache server (see http://djangobook.com/deploying-django/). Install wsgi with the following doc : http://modwsgi.readthedocs.io/en/develop/user-guides/quick-installation-guide.html.</p>
<pre><code>wget https://github.com/GrahamDumpleton/mod_wsgi/archive/4.5.14.tar.gz
sudo apt-get install apache2-dev
sudo make
sudo make install (do not forget the sudo otherwise there is a weird error!)</code></pre>
<h3 id="database-setup">Database setup</h3>
<p>Create the database from phpmyadmin, and make the migrations :</p>
<pre><code>python manage.py makemigrations
python manage.py migrate</code></pre>
<h3 id="django-settings">Django settings</h3>
<p>Do the following changes in settings.py :</p>
<ul>
<li>Add the server's ip address (or host name) in ALLOWED_HOSTS parameter</li>
<li>Configure the database in DATABASES parameter in the django file settings.py</li>
<li>Make django sql migrations with : python manage.py makemigrations, and then python manage.py migrate.</li>
<li>Set DEBUG = False in settings.py.</li>
</ul>
<p>The following modifications are needed for a website serving in https :</p>
<p>In settings.py :</p>
<pre><code># secure proxy SSL header and secure cookies
SECURE_PROXY_SSL_HEADER = (&#39;HTTP_X_FORWARDED_PROTO&#39;, &#39;https&#39;)
SESSION_COOKIE_SECURE = True
CSRF_COOKIE_SECURE = True

# session expire at browser close
SESSION_EXPIRE_AT_BROWSER_CLOSE = True

# wsgi scheme
os.environ[&#39;wsgi.url_scheme&#39;] = &#39;https&#39;</code></pre>
<p>In wsgi.py :</p>
<pre><code>os.environ[&#39;HTTPS&#39;] = &quot;on&quot;</code></pre>
<h3 id="setup-ssl-certificate-https">Setup SSL certificate (https)</h3>
<p>We have a SSL certificate bought on Namecheap. The Namecheap account is GregoireJauvion:TuringBiotech.</p>
<p>The following commands have been types in /etc/apache2/ssl/.</p>
<p>First, generate a private key with :</p>
<pre><code>sudo openssl genrsa -des3 -out apache.key 2048</code></pre>
<p>The pass phrase (needed when restarting apache2 server) is Turing.</p>
<p>Then, generate the csr file with :</p>
<pre><code>sudo openssl req -new -key /etc/apache2/ssl/apache.key -out apache.csr</code></pre>
<p>When the common name is asked for, we typed turingbio.tech (www.turingbio.tech would be better, but it works).</p>
<p>Finally :</p>
<pre><code>sudo openssl x509 -req -days 365 -in apache.csr -signkey apache.key -out apache.crt</code></pre>
<p>These files are needed by Namecheap to generate the certificate. Then, the certificate is received by e-mail and copied in /etc/apache2/ssl/.</p>
<p>Then enable SSL on apache :</p>
<pre><code>sudo a2enmod ssl</code></pre>
<h3 id="apache-server-configuration">Apache server configuration</h3>
<p>Below the configuration files of the Apache server.</p>
<p>The following lines have been added in /etc/apache2/apache2.conf :</p>
<pre><code>WSGIPythonPath /home/bio/bio_simulation/website/bio_simulation

#WSGIDaemonProcess simulation python-path=/home/bio/bio_simulation/website/bio_simulation:/usr/local/lib/python2.7/site-packages
#WSGIProcessGroup simulation</code></pre>
<p>Note : the 2 commented lines used to work but do not work anymore, I think they are not really needed.</p>
<p>Finally, define the wsgi module configuration in /etc/apache2/sites-available/default-ssl.conf. The first :</p>
<pre><code>&lt;IfModule mod_ssl.c&gt;
        &lt;VirtualHost _default_:443&gt;
                ServerName www.turingbio.tech
                ServerAdmin admin@turingbio.tech

                ErrorLog ${APACHE_LOG_DIR}/error.log
                CustomLog ${APACHE_LOG_DIR}/access.log combined

                # Django website configuration
                LoadModule wsgi_module     /usr/lib/apache2/modules/mod_wsgi.so

                WSGIScriptAlias / /home/bio/bio_simulation/website/bio_simulation/simulation/wsgi.py

                &lt;Directory /home/bio/bio_simulation/website/bio_simulation/simulation&gt;
                &lt;Files wsgi.py&gt;
                Require all granted
                &lt;/Files&gt;
                &lt;/Directory&gt;

                Alias /static/ /home/bio/bio_simulation/website/bio_simulation/simulation/static/

                &lt;Directory /home/bio/bio_simulation/website/bio_simulation/simulation/static&gt;
                Require all granted
                &lt;/Directory&gt;

                SSLEngine on
                SSLCertificateFile /etc/apache2/ssl/turingbio_tech.crt
                SSLCertificateKeyFile /etc/apache2/ssl/apache.key
                SSLCertificateChainFile /etc/apache2/ssl/turingbio_tech.ca-bundle
                Header set Strict-Transport-Security &quot;max-age=31536000; includeSubDomains&quot;
        &lt;/VirtualHost&gt;

        # This part is used to redirect turingbio.tech requests to www.turingbio.tech
        &lt;VirtualHost _default_:443&gt;
                ServerName turingbio.tech
                Redirect permanent / https://www.turingbio.tech/
        &lt;/VirtualHost&gt;

        # The 2 following parts are needed to redirect http requests to https requests
        &lt;VirtualHost *:80&gt;
                ServerName www.turingbio.tech
                Redirect permanent / https://www.turingbio.tech
        &lt;/VirtualHost&gt;

        &lt;VirtualHost *:80&gt;
                ServerName turingbio.tech
                Redirect permanent / https://www.turingbio.tech
        &lt;/VirtualHost&gt;
&lt;/IfModule&gt;</code></pre>
<p>We need also to activate manually the SSL site :</p>
<pre><code>sudo a2ensite default-ssl
sudo service apache2 reload</code></pre>
<p>Finally, restart apache server and it should work :</p>
<pre><code>sudo service apache2 restart</code></pre>
<p>If you modify the website, you only need to pull your modifications and restart aache2 server.</p>
<h3 id="magic-step">Magic step</h3>
<p>There is also this step I did but I don't know if that's really necessary :</p>
<p>Execute :</p>
<pre><code>sudo ln -s /etc/apache2/mods-available/headers.load /etc/apache2/mods-enabled/headers.load</code></pre>
<p>And add the following line in default-ssl.conf :</p>
<pre><code>Add Header set Strict-Transport-Security &quot;max-age=31536000; includeSubDomains&quot;</code></pre>
<h2 id="simulation-server">Simulation server</h2>
<p>First, compile the C++ library :</p>
<ul>
<li>Install qmake : sudo apt-get install qt5-default</li>
<li>Create Makefile : &quot;qmake sim-engine.pro -r -spec linux-g++ CONFIG+=debug&quot;</li>
<li>In src/Makefile, replace &quot;g++&quot; with &quot;g++ -std=c++11&quot;</li>
<li>Compile library by executing make in src/</li>
<li>Copy the library in /usr/lib/</li>
</ul>
<p>The http server running the simulations is run with the following commands (the logs are written in bio_simulation/server/server.log) :</p>
<pre><code>nohup python simulation_server.py --host {ip} --lib-path /usr/lib/libsim-engine.so</code></pre>
<p>If you want to run simulations, use the python object SimulationClient({ip}) (defined in simulation_client.py).</p>
<p>Remarks : because of json library, we need the latest version of gcc (4.9). You can check the version used on the server with gcc --version. If an old version is installed, upgrade it using this link : http://stackoverflow.com/questions/25147363/how-to-install-g-4-9-on-debian-wheezy-armel.</p>
<h2 id="python-repository">Python repository</h2>
<p>We should set up a pypi repository to host our python modules (low priority).</p>
<p>For the moment, the best strategy is to put the python modules we want to import in /usr/local/lib/python2.7/site-packages/.</p>
<h2 id="connect-to-the-server-with-graphical-interface">Connect to the server with graphical interface</h2>
<p>Pour info, pour se connecter en SSH avec interface graphique depuis un mac (utile pour voir la commande lancée par qtcreator notamment) :</p>
<ul>
<li>Install XQuartz : brew install Caskroom/cask/xquartz</li>
<li>Run XQuartz application : /Applications/Utilities/XQuartz.app/Contents/MacOS/X11</li>
<li>SSH connection enabling X forwarding : ssh -X pi@...</li>
<li>Then, you can run any application with a graphical interface, for example : ./usr/bin/qtcreator</li>
</ul>
</body>
</html>
